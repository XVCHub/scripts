local a,b,c,d,e,f,g = string.byte, string.char, string.sub, string.len, table.concat, math.random, table.insert
local function encode(str)
    local encoded = {}
    for i=1, #str do
        encoded[i] = string.format("%02x", a(str, i))
    end
    return table.concat(encoded)
end

local function decode(str)
    local decoded = {}
    for i=1, #str, 2 do
        decoded[#decoded + 1] = b(tonumber(str:sub(i, i + 1), 16))
    end
    return table.concat(decoded)
end
